#!/bin/bash


cd /home/USSR/zx265/storage/zijian

mkdir bamfiles #folder for sorted bam files 
mkdir counts #folder for the final count summary 

SAMPLES="EGAF00002390717 EGAF00002390718 EGAF00002390719 EGAF00002390720 EGAF00002390721 EGAF00002390722 EGAF00002390723 EGAF00002390724 EGAF00002390725 EGAF00002390726 EGAF00002390727 EGAF00002390728 EGAF00002390729 EGAF00002390730 EGAF00002390731 EGAF00002390732 EGAF00002390733 EGAF00002390734 EGAF00002390735 EGAF00002390736 EGAF00002390737 EGAF00002390738 EGAF00002390739 EGAF00002390740 EGAF00002390741 EGAF00002390742 EGAF00002390743 EGAF00002390744 EGAF00002390745 EGAF00002390746 EGAF00002390747 EGAF00002390748 EGAF00002390749 EGAF00002390750 EGAF00002390751 EGAF00002390752 EGAF00002390753 EGAF00002390754 EGAF00002390755 EGAF00002390756 EGAF00002390757 EGAF00002390758 EGAF00002390759 EGAF00002390760 EGAF00002390761 EGAF00002390762 EGAF00002390763 EGAF00002390764 EGAF00002390765 EGAF00002390766 EGAF00002390767 EGAF00002390768 EGAF00002390769 EGAF00002390770 EGAF00002390771 EGAF00002390772 EGAF00002390773 EGAF00002390774 EGAF00002390775 EGAF00002390776 EGAF00002390777 EGAF00002390778 EGAF00002390779 EGAF00002390780 EGAF00002390781 EGAF00002390782 EGAF00002390783 EGAF00002390784 EGAF00002390785 EGAF00002390786 EGAF00002390787 EGAF00002390788 EGAF00002390789 EGAF00002390790 EGAF00002390791 EGAF00002390792 EGAF00002390793 EGAF00002390794 EGAF00002390795 EGAF00002390796 EGAF00002390797 EGAF00002390798 EGAF00002390799 EGAF00002390800 EGAF00002390801 EGAF00002390802 EGAF00002390803 EGAF00002390804 EGAF00002390805 EGAF00002390806 EGAF00002390807 EGAF00002390808 EGAF00002390809 EGAF00002390810 EGAF00002390811 EGAF00002390812 EGAF00002390813 EGAF00002390814 EGAF00002390815 EGAF00002390816 EGAF00002390817 EGAF00002390818 EGAF00002390819 EGAF00002390820 EGAF00002390821 EGAF00002390822 EGAF00002390823 EGAF00002390824 EGAF00002390825 EGAF00002390826 EGAF00002390827 EGAF00002390828 EGAF00002390829 EGAF00002390830 EGAF00002390831 EGAF00002390832 EGAF00002390833 EGAF00002390834 EGAF00002390835 EGAF00002390836 EGAF00002390837 EGAF00002390838 EGAF00002390839 EGAF00002390840 EGAF00002390841 EGAF00002390842 EGAF00002390843 EGAF00002390844 EGAF00002390845 EGAF00002390846 EGAF00002390847 EGAF00002390848 EGAF00002390849 EGAF00002390850 EGAF00002390851 EGAF00002390852 EGAF00002390853 EGAF00002390854 EGAF00002390855 EGAF00002390856 EGAF00002390857 EGAF00002390858 EGAF00002390859 EGAF00002390860 EGAF00002390861 EGAF00002390862 EGAF00002390863 EGAF00002390864 EGAF00002390865 EGAF00002390866 EGAF00002390867 EGAF00002390868 EGAF00002390869 EGAF00002390870 EGAF00002390871 EGAF00002390872 EGAF00002390873 EGAF00002390874 EGAF00002390875 EGAF00002390876 EGAF00002390877 EGAF00002390878 EGAF00002390879 EGAF00002390880 EGAF00002390881 EGAF00002390882 EGAF00002390883 EGAF00002390884 EGAF00002390885 EGAF00002390886 EGAF00002390887 EGAF00002390888 EGAF00002390889 EGAF00002390890 EGAF00002390891 EGAF00002390892 EGAF00002390893 EGAF00002390894 EGAF00002390895 EGAF00002390896 EGAF00002390897 EGAF00002390898 EGAF00002390899 EGAF00002390900 EGAF00002390901 EGAF00002390902 EGAF00002390903 EGAF00002390904 EGAF00002390905 EGAF00002390906 EGAF00002390907 EGAF00002390908 EGAF00002390909 EGAF00002390910 EGAF00002390911 EGAF00002390912 EGAF00002390913 EGAF00002390914 EGAF00002390915 EGAF00002390916 EGAF00002390917 EGAF00002390918 EGAF00002390919 EGAF00002390920 EGAF00002390921 EGAF00002390922 EGAF00002390923 EGAF00002390924 EGAF00002390925 EGAF00002390926 EGAF00002390927 EGAF00002390928 EGAF00002390929 EGAF00002390930 EGAF00002390931 EGAF00002390932 EGAF00002390933 EGAF00002390934 EGAF00002390935 EGAF00002390936 EGAF00002390937 EGAF00002390938 EGAF00002390939 EGAF00002390940 EGAF00002390941 EGAF00002390942 EGAF00002390943 EGAF00002390944 EGAF00002390945 EGAF00002390946 EGAF00002390947 EGAF00002390948 EGAF00002390949 EGAF00002390950 EGAF00002390951 EGAF00002390952 EGAF00002390953 EGAF00002390954 EGAF00002390955 EGAF00002390956 EGAF00002390957 EGAF00002390958 EGAF00002390959 EGAF00002390960 EGAF00002390961 EGAF00002390962 EGAF00002390963 EGAF00002390964 EGAF00002390965 EGAF00002390966 EGAF00002390967 EGAF00002390968 EGAF00002390969 EGAF00002390970 EGAF00002390971 EGAF00002390972 EGAF00002390973 EGAF00002390974 EGAF00002390975 EGAF00002390976 EGAF00002390977 EGAF00002390978 EGAF00002390979 EGAF00002390980 EGAF00002390981 EGAF00002390982 EGAF00002390983 EGAF00002390984 EGAF00002390985 EGAF00002390986 EGAF00002390987 EGAF00002390988 EGAF00002390989 EGAF00002390990 EGAF00002390991 EGAF00002390992 EGAF00002390993 EGAF00002390994 EGAF00002390995 EGAF00002390996 EGAF00002390997"

for SAMPLE in $SAMPLES;

   do							
	

cd /home/USSR/zx265/storage/zijian/EGAF00002390717


java -jar ../picard.jar SamToFastq \

I=BSF_0122_C4H13ACXX_1#CEMM_D08.bam \

FASTQ=output_R1.fastq \

SECOND_END_FASTQ=output_R2.fastq




/home/USSR/zx265/Software/hisat2-2.2.1/hisat2 -p 10 \

--dta -x /home/USSR/zx265/storage/Adrien_data/ref_data/hisat2 \

-1 output_R1.fastq \

-2 output_R2.fastq \

-S output.sam


~/Software/samtools-1.9/samtools sort -@ 10 -o output.bam output.sam

done 

/home/USSR/zx265/Software/subread-2.0.0-Linux-x86_64/bin/featureCounts \

-p -a /home/USSR/zx265/storage/Adrien_data/ref_data/Homo_sapiens.GRCh38.105.gtf \

-F gtf -g gene_id -T 10 \

-o expres_matrix.txt output.bam
